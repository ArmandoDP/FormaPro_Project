---
// Header - Navigation bar
// ------------
// Description: navigation bars offer a persistent and convenient way to switch between primary destinations in an app.
// Structure:
// - Logo: the logo of the website
// - Menu toggle: the mobile menu toggle of the navigation bar
// - Navigation Links: the navigation links of the menu
// - Actions: action buttons for the navigation bar
// - Theme Switcher: the mode (light/dark) switcher of the website

// Reference: https://wind-ui.com/components/navbars/

// Components
// - UI
import { Icon } from 'astro-icon/components'
import Button from './Button.astro'
import Switcher from './ModeSwitcher.astro'

// Data
import { navigationBarData } from '../../config/navigationBar'
const { logo, navItems, navActions } = navigationBarData

// Determine current path
const path = new URL(Astro.request.url).pathname
function isActivePath(currentPath: string): boolean {
	return path === currentPath || path === `${currentPath}/`
}

// Type assertion for navActions to ensure type safety
const savedNavActions = navActions.map((action) => ({
	...action,
	size: action.size as 'base' | 'lg' | 'sm',
	style: action.style as 'primary' | 'secondary' | 'neutral'
}))
---

<div class="w-full bg-[#052B31] text-white sticky top-0 z-[40] items-center justify-between px-6 text-sm font-medium">
    <div class="container mx-auto px-6 h-[50px] flex justify-between items-center">
        <!-- Dirección + Teléfono -->
		<p class="whitespace-nowrap flex items-center gap-2 mt-5">
			Av. Ramón Rodríguez, Jardines de Querétaro, 76020 Santiago de Querétaro, Qro.
			<span class="opacity-60">|</span>
			+52 (55) 3446-9970
		</p>

        <!-- BOTÓN WHATSAPP -->
        <a
            href="https://wa.me/5215534469970"
            target="_blank"
            class="bg-[#d62828] text-white flex items-center gap-2 font-semibold px-5 py-2 rounded-l-xl rounded-r-xl shadow-md hover:bg-[#b71f1f] transition"
        >
            <!-- Icono WhatsApp -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" class="w-6 h-6 fill-white">
                <path d="M16.001 3.2c-7.064 0-12.8 5.736-12.8 12.8 0 2.255.589 4.451 1.708 6.392L3.2 28.8l6.58-1.708A12.73 12.73 0 0 0 16 28.8C23.063 28.8 28.8 23.064 28.8 16S23.063 3.2 16.001 3.2zm0 23.466c-2.07 0-4.087-.555-5.857-1.607l-.42-.248-3.907 1.012 1.04-3.81-.273-.392a10.59 10.59 0 0 1-1.66-5.665c0-5.878 4.78-10.657 10.657-10.657 5.878 0 10.657 4.78 10.657 10.657 0 5.878-4.78 10.657-10.657 10.657zm5.897-7.957c-.322-.161-1.905-.94-2.201-1.047-.296-.108-.513-.161-.73.161-.216.323-.838 1.047-1.028 1.263-.19.215-.379.242-.701.081-.322-.162-1.359-.5-2.588-1.595-.957-.853-1.604-1.904-1.79-2.226-.187-.323-.02-.497.141-.658.145-.144.322-.377.483-.565.162-.189.215-.324.323-.54.108-.215.054-.404-.027-.565-.081-.162-.73-1.764-1.001-2.414-.263-.63-.53-.544-.73-.553-.19-.008-.404-.01-.62-.01-.216 0-.565.081-.858.404-.296.323-1.125 1.1-1.125 2.683 0 1.582 1.151 3.112 1.312 3.328.162.216 2.267 3.46 5.51 4.848.771.333 1.37.533 1.837.682.771.245 1.47.21 2.021.127.617-.092 1.905-.779 2.175-1.532.27-.754.27-1.403.189-1.532-.081-.127-.296-.215-.617-.377z"/>
            </svg>

            ¡Contactar ahora!
        </a>
    </div>
</div>
<header class="header">
	<div class="header__container">
		<nav aria-label="main navigation" role="navigation" class="header__nav">
			<!-- Logo -->
			<a href="/" class="header__logo">
				<img src={logo.src} alt={logo.alt} width="200" height="200" />
				<!-- <span>{logo.text}</span> -->
			</a>

			<!-- Menu toggle -->
			<button
				id="header-toggle"
				class="header__toggle"
				aria-expanded="false"
				aria-label="Toggle navigation"
			>
				<div class="header__toggle-inner">
					<span aria-hidden="true"></span>
					<span aria-hidden="true"></span>
					<span aria-hidden="true"></span>
				</div>
			</button>

			<!-- Navigation links -->
			<ul role="menubar" aria-label="Select page" class="header__menu">
				{
					navItems.map((item) => (
						<li role="none" class="header__menu-item">
							{!item.submenu ? (
								<a
									href={item.link}
									role="menuitem"
									class={`header__menu-link ${isActivePath(item.link) ? 'active' : ''}`}
								>
									{item.name}
								</a>
							) : (
								<span
									role="menuitem"
									class={`header__menu-link ${isActivePath(item.link) ? 'active' : ''}`}
								>
									{item.name}
									<Icon name="chevron-down" class="header__menu-chevron" />
								</span>
							)}
							{item.submenu && (
								<ul class="header__submenu">
									{item.submenu.map((subItem) => (
										<li role="none" class="header__submenu-item">
											<a
												href={subItem.link}
												role="menuitem"
												class={`header__menu-link ${isActivePath(item.link) ? 'active' : ''}`}
											>
												{subItem.name}
											</a>
										</li>
									))}
								</ul>
							)}
						</li>
					))
				}
			</ul>

			<!-- Theme Switcher -->
			<Switcher />

			<!-- Navigation action buttons -->
			<div class="header__actions">
				{
					savedNavActions.map((action) => (
						<Button classes="flex-auto" size={action.size} style={action.style} modal="signup">
							{action.name}
						</Button>
					))
				}
			</div>
		</nav>
	</div>
</header>

<style>
	.header {
		@apply sticky z-20 w-full bg-white dark:bg-neutral-900;
		top: 42px;
	}
	.header:before {
		@apply block h-full w-full bg-white/90 lg:backdrop-blur-sm dark:bg-neutral-900/90;
	}
	.header__container {
		@apply container relative mx-auto px-6;
	}
	.header__logo {
		@apply flex flex-auto items-center gap-2 whitespace-nowrap py-3 font-headings text-2xl font-black tracking-wider focus:outline-none;
	}
	.header__nav {
		@apply flex h-[5.5rem] items-stretch gap-6 font-medium text-neutral-700 lg:justify-between dark:text-neutral-50;
	}
	.header__menu {
		@apply invisible absolute left-0 top-0 z-[-1] ml-auto h-dvh w-full justify-center overflow-hidden overflow-y-auto overscroll-contain bg-white/90 px-8 py-[6rem] font-medium opacity-0 transition-[opacity,visibility] duration-300 lg:visible lg:relative lg:top-0 lg:z-0 lg:flex lg:h-full lg:w-auto lg:items-stretch lg:overflow-visible lg:bg-white/0 lg:px-0 lg:py-0 lg:pt-0 lg:opacity-100 dark:bg-neutral-900/90 dark:lg:bg-transparent;
	}
	.header__menu--open {
		@apply visible opacity-100 backdrop-blur-sm;
	}
	.header__menu-item {
		@apply relative flex cursor-pointer flex-col items-stretch lg:flex-row;
	}
	.header__menu-link {
		@apply relative flex items-center gap-1 py-4 transition-colors duration-300 hover:text-primary-500 focus:text-primary-600 focus:outline-none focus-visible:outline-none lg:px-6 [&.active]:text-primary-500;
	}
	.header__menu-chevron {
		@apply h-4 w-4 transition-transform [.header\_\_menu-item.open_&]:rotate-180;
	}
	.header__submenu {
		@apply left-0 top-full hidden animate-dropdown rounded bg-neutral-300/10 px-4 lg:absolute lg:min-w-48 lg:rounded-t-none lg:bg-white/90 lg:p-0 lg:shadow-lg lg:shadow-neutral-700/5 lg:backdrop-blur-sm dark:bg-neutral-500/10 lg:dark:bg-neutral-900/90 lg:dark:shadow-neutral-950/50 [.header\_\_menu-item.open_&]:block;
	}
	.header__submenu-item {
		@apply hidden [.header\_\_menu-item.open_&]:block;
	}
	.header__submenu-link {
		@apply px-8 py-4 hover:text-primary-500 [.header\_\_menu-item.open_&]:flex;
	}
	.header__toggle {
		@apply relative order-10 block h-10 w-10 self-center lg:hidden [&--open]:visible [&--open]:opacity-100;
	}
	.header__toggle-inner {
		@apply absolute left-1/2 top-1/2 w-6 -translate-x-1/2 -translate-y-1/2 transform;
	}
	.header__toggle-inner span {
		@apply absolute block h-0.5 transform rounded-full bg-neutral-900 transition-all duration-300 dark:bg-white;
	}
	.header__toggle-inner span:nth-child(1) {
		@apply w-9/12 -translate-y-2 [.header\_\_toggle--open_&]:w-6 [.header\_\_toggle--open_&]:translate-y-0 [.header\_\_toggle--open_&]:rotate-45;
	}
	.header__toggle-inner span:nth-child(2) {
		@apply w-6 [.header\_\_toggle--open_&]:-rotate-45;
	}
	.header__toggle-inner span:nth-child(3) {
		@apply w-1/2 origin-top-left translate-y-2 [.header\_\_toggle--open_&]:w-0;
	}
	.header__actions {
		@apply fixed bottom-0 left-0 hidden w-full items-center justify-between gap-4 border-t border-neutral-100 bg-white px-6 py-4 lg:relative lg:ml-auto lg:flex lg:w-auto lg:border-none lg:bg-transparent lg:px-0 lg:py-0 dark:border-neutral-800 dark:bg-neutral-950 lg:dark:bg-transparent [.header\_\_menu--open~&]:flex;
	}
</style>
